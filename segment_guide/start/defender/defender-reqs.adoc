// WE PULL THIS CONTENT FROM https://github.com/aporeto-inc/junon
// DO NOT EDIT THIS FILE.
// YOU MUST SUBMIT A PR AGAINST THE UPSTREAM REPO.
// THE UPSTREAM REPO IS CURRENTLY PRIVATE.

== System requirements

=== Prisma Cloud Compute requirements

You must meet the base
https://docs.paloaltonetworks.com/prisma/prisma-cloud/20-04/prisma-cloud-compute-edition-admin/install/system_requirements.html[Defender
requirements]. This page describes the additional requirements for
Defenders with Segment enabled.

=== Compatibility

* Segment is not compatible with
https://docs.paloaltonetworks.com/prisma/prisma-cloud/20-08/prisma-cloud-compute-edition-admin/firewalls.html[CNAF]
at this time. If you have enabled CNAF on the target host, disable it
before deploying Defenders with Segment enabled.
* Segment does not support
https://kubernetes.io/docs/tasks/configure-pod-container/assign-cpu-resource/#specify-a-cpu-request-and-a-cpu-limit[Kubernetes
CPU limits]. Refer to our
https://medium.com/engineering-at-palo-alto-networks/kubernetes-scheduling-and-timescales-e98d8e31d304[blog
post] for more details.

=== Orchestrators

* Kubernetes 1.11 or later
* OpenShift 3.11 or later

=== Linux

==== Service

When deployed as a Linux service, such as to protect a host, the
Defender with Segment enabled requires a Linux 3.14 or later kernel. +
It depends upon the following libraries:

* `elfutils-libelf`
* `conntrack-tools`
* `ipset`

We have certified the Defender on the following distributions.

[cols="<,<",options="header",]
|===
|Distribution |Versions
|Amazon Linux |AMI, 2
|CentOS |7*, 7 CIS*
|Debian |9
|RedHat Enterprise Linux |7 CIS*, 7.5*, 7.6*
|Ubuntu |14.04†, 16.04, 18.04
|===

pass:[*] _You must disable_ `firewalld`.

† _Check the kernel version. If 3.13 or earlier, you must upgrade your
kernel_.

==== Container

We provide the Defender with Segment enabled as a standalone container
to allow integration with orchestrators other than Kubernetes. The
target host must have:

* Docker 18.02 or later
* Docker
https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file[userland
proxy disabled: `"userland-proxy": false`]
* http://conntrack-tools.netfilter.org/manual.html[Netfilter
`conntrack`]
+
[cols="<,<",options="header",]
|===
|Linux kernel version |conntrack version
|4.19 and later |`nf_conntrack`
|4.18 and earlier |`nf_conntrack_ipv4` and `nf_conntrack_ipv6`
|===

==== Kernel capabilities

* `CAP_SYS_PTRACE`: to access the `/proc` file system. Example:
`/proc/<pid>/root`
* `CAP_NET_ADMIN`: to program `iptables`.
* `CAP_NET_RAW`: the Defender uses raw sockets for the UDP datapath and
in diagnostic ping implementations
* `CAP_SYS_RESOURCE`: to set and override resource limits
(`setrlimit syscall`)
* `CAP_SYS_ADMIN`: to call, mount, and load extended Berkeley Packet
Filter (eBPF)
* `CAP_SYS_MODULE`: to ensure kernel modules are loaded like ip_tables,
iptable_mangle, etc. (see list above). No proprietary kernel module is
loaded.

==== Kernel modules

* `net/netfilter/xt_cgroup.ko`: module to match the process control
group. +
* `net/netfilter/xt_limit.ko`: rate-limit match
* `net/netfilter/xt_multiport.ko`: multiple port matching for TCP, UDP,
UDP-Lite, SCTP and DCCP
* `net/netfilter/xt_connmark.ko`: connection mark operations +
* `net/netfilter/xt_REDIRECT.ko`: connection redirection to localhost +
* `net/netfilter/xt_string.ko`: string-based matching +
* `net/netfilter/xt_HMARK.ko`: packet marking using hash calculation +
* `net/netfilter/xt_LOG.ko`: IPv4/IPv6 packet logging +
* `net/netfilter/xt_bpf.ko`: BPF filter match +
* `net/netfilter/xt_state.ko`: `ip[6]_tables` connection tracking state
match module +
* `net/netfilter/xt_set.ko`: IP set match and target module
* `net/netfilter/nf_nat_redirect.ko`: used by `xt_REDIRECT`
* `net/netfilter/nf_log_common.ko`: used by `nf_log_ipv4`
* `net/ipv6/netfilter/nf_conntrack_ipv6.ko`: Linux connection tracking
table +
* `net/ipv4/netfilter/nf_log_ipv4.ko`: Netfilter IPv4 packet logging +
* `net/netfilter/ipset/ip_set.ko`: core IP set support, used by
`ip_set_bitmap_port`,`xt_set`,`ip_set_hash_net`,`ip_set_hash_netport`
* `net/netfilter/ipset/ip_set_bitmap_port.ko`: Ipset: bitmap:port +
* `net/netfilter/ipset/ip_set_hash_netport.ko`: Ipset: hash:net,port +
* `net/netfilter/ipset/ip_set_hash_net.ko`: Ipset: hash:net
* `lib/ts_bm.ko`: Boyer-Moore string matching algorithm
* `net/sched/cls_cgroup.ko`: Control Group Classifier +
* `ip_tables.ko`: iptables +
* `iptable_nat.ko`: iptables NAT table support +
* `iptable_mangle.ko`: iptables mangle table support

=== Windows

* Windows Server 2016 or 2019
* PowerShell (64-bit)
