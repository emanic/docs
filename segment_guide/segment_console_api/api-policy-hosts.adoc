== policy/hosts

=== HostService

Represents services that a host must expose and protect.

==== Example

[source,json]
----
{
  "hostModeEnabled": false,
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /hostservices`

Retrieves the list of host services.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /hostservices`

Creates a new host service.

===== `DELETE /hostservices/:id`

Deletes the host service with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /hostservices/:id`

Retrieves the host service with the given ID.

Parameters:

* `archived` (`boolean`): Also retrieve the objects that have been
archived.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /hostservices/:id`

Updates the host service with the given ID.

===== `GET /enforcers/:id/hostservices`

Returns a list of the host services policies that apply to this
enforcer.

Parameters:

* `appliedServices` (`boolean`): Valid when retrieved for a given
enforcer and returns the applied services.
* `setServices` (`boolean`): Instructs the backend to cache the services
that were resolved. services.

===== `GET /hostservicemappingpolicies/:id/hostservices`

Returns the list of host services that are referenced by this mapping.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `hostModeEnabled` `boolean`

Forces the corresponding enforcers to enable host protection. When
`true`, all incoming and outgoing flows will be monitored. Flows will be
allowed if and only if a network policy has been created to allow the
flow. The option applies to all enforcers to which the host service is
mapped.

===== `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `propagate` `boolean`

Propagates the policy to all of its children.

===== `protected` `boolean`

Defines if the object is protected.

===== `services` `[]string`

Lists all protocols and ports a service is running. A service entry can
be defined by a protocol and port `(tcp/80)`, or range of protocol/port
pairs `(udp/80:100)`. If no protocol is provided, it is assumed to be
TCP. Only `tcp` and `udp` protocols are allowed.

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

=== HostServiceMappingPolicy

Host service mapping allows you to map host services to the enforcers
which should implement them. You must map host services to one or more
enforcers for the host services to have any effect.

==== Example

[source,json]
----
{
  "disabled": false,
  "fallback": false,
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /hostservicemappingpolicies`

Retrieves the list of host service mappings.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /hostservicemappingpolicies`

Creates a new host service mapping.

===== `DELETE /hostservicemappingpolicies/:id`

Deletes the mapping with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /hostservicemappingpolicies/:id`

Retrieves the mapping with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /hostservicemappingpolicies/:id`

Updates the mapping with the given ID.

===== `GET /hostservicemappingpolicies/:id/enforcers`

Returns the list of enforcers that are affected by this mapping.

===== `GET /hostservicemappingpolicies/:id/hostservices`

Returns the list of host services that are referenced by this mapping.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `activeDuration` `string` [`format=^[0-9]+[smh]$`]

Defines for how long the policy will be active according to the
`activeSchedule`.

===== `activeSchedule` `string`

Defines when the policy should be active using the cron notation. The
policy will be active for the given `activeDuration`.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `disabled` `boolean`

Defines if the property is disabled.

===== `fallback` `boolean`

Indicates that this is fallback policy. It will only be applied if no
other policies have been resolved. If the policy is also propagated it
will become a fallback for children namespaces.

===== `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `object` `[][]string`

A tag or tag expression identifying the host service(s) to be mapped.

===== `propagate` `boolean`

Propagates the policy to all of its children.

===== `protected` `boolean`

Defines if the object is protected.

===== `subject` `[][]string`

A tag or tag expression identifying the enforcer(s) that should
implement the specified host service(s).

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.
