== policy/enforcerconfig

=== EnforcerProfile

Allows you to create reusable configuration profiles for your defenders.
Defender profiles contain various startup information that can (for
some) be updated live. Defender profiles are assigned to defenders using
a defender profile mapping.

==== Example

[source,json]
----
{
  "kubernetesMetadataExtractor": "PodAtomic",
  "kubernetesSupportEnabled": false,
  "metadataExtractor": "Docker",
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /enforcerprofiles`

Retrieves the list of defender profiles.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /enforcerprofiles`

Creates a new defender profile.

===== `DELETE /enforcerprofiles/:id`

Deletes the defender profile with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /enforcerprofiles/:id`

Retrieves the defender profile with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /enforcerprofiles/:id`

Updates the defender profile with the given ID.

===== `GET /enforcerprofilemappingpolicies/:id/enforcerprofiles`

Returns the list of defender profiles that a defender profile mapping
matches.

===== `GET /enforcers/:id/enforcerprofiles`

Returns the defender profile that must be used by a defender.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `excludedInterfaces`

Type: `[]string`

Ignore traffic with a source or destination matching the specified
interfaces.

===== `excludedNetworks`

Type: `[]string`

Ignore any networks specified here and do not even report any flows.
This can be useful for excluding localhost loopback traffic, ignoring
traffic to the Kubernetes API, and using Segment for SSH only.

===== `ignoreExpression`

Type: `[][]string`

A tag expression that identifies processing units to ignore. This can be
useful to exclude `kube-system` pods, AWS EC2 agent pods, and
third-party agents.

===== `kubernetesMetadataExtractor`

_This attribute is deprecated_.

Type: `enum(KubeSquall | PodAtomic | PodContainers)`

This field is kept for backward compatibility for defenders <= 3.5.

Default value:

[source,json]
----
"PodAtomic"
----

===== `kubernetesSupportEnabled`

_This attribute is deprecated_.

Type: `boolean`

This field is kept for backward compatibility for defenders <= 3.5.

===== `metadata` [`creation_only`]

Type: `[]string`

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `metadataExtractor`

_This attribute is deprecated_.

Type: `enum(Docker | ECS | Kubernetes)`

This field is kept for backward compatibility for defenders <= 3.5.

Default value:

[source,json]
----
"Docker"
----

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `targetNetworks`

Type: `[]string`

If empty, the defender auto-discovers the TCP networks. Auto-discovery
works best in Kubernetes and OpenShift deployments. You may need to
manually specify the TCP networks if middle boxes exist that do not
comply with https://tools.ietf.org/html/rfc7413[TCP Fast Open RFC 7413].

===== `targetUDPNetworks`

Type: `[]string`

If empty, Segment enforces all UDP networks. This works best when all
UDP networks have defenders. If some UDP networks do not have defenders,
you may need to manually specify the UDP networks that should be
enforced.

===== `trustedCAs`

Type: `[]string`

List of trusted certificate authorities. If empty, the main chain of
trust will be used.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== EnforcerProfileMappingPolicy

Allows you to map a defender profile to one or more defenders. The
mapping can also be propagated down to the child namespace.

==== Example

[source,json]
----
{
  "disabled": false,
  "fallback": false,
  "name": "the name",
  "object": [
    [
      "a=a",
      "b=b"
    ],
    [
      "c=c"
    ]
  ],
  "propagate": false,
  "protected": false,
  "subject": [
    [
      "a=a",
      "b=b"
    ],
    [
      "c=c"
    ]
  ]
}
----

==== Relations

===== `GET /enforcerprofilemappingpolicies`

Retrieves the list of defender profile mappings.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /enforcerprofilemappingpolicies`

Creates a new defender profile mappings.

===== `DELETE /enforcerprofilemappingpolicies/:id`

Deletes the mapping with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /enforcerprofilemappingpolicies/:id`

Retrieves the mapping with the given ID.

===== `PUT /enforcerprofilemappingpolicies/:id`

Updates the mapping with the given ID.

===== `GET /enforcerprofilemappingpolicies/:id/enforcerprofiles`

Returns the list of defender profiles that a defender profile mapping
matches.

===== `GET /enforcerprofilemappingpolicies/:id/enforcers`

Returns the list of defenders affected by a defender profile mapping.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `disabled`

Type: `boolean`

Defines if the property is disabled.

===== `fallback`

Type: `boolean`

Indicates that this is fallback policy. It will only be applied if no
other policies have been resolved. If the policy is also propagated it
will become a fallback for children namespaces.

===== `metadata` [`creation_only`]

Type: `[]string`

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `object`

Type: `[][]string`

The tag or tag expression that identifies the defender profile to be
mapped.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `subject`

Type: `[][]string`

The tag or tag expression that identifies the defenders that should
implement the mapped profile.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== TrustedCA

Represents a trusted certificate authority (CA).

==== Relations

===== `GET /trustedcas`

Retrieves the trusted CAs of a namespace.

Parameters:

* `type` (`enum(Any | X509 | SSH | JWT)`): The type of certificates that
it should return.

===== `GET /enforcers/:id/trustedcas`

Returns the list of certificate authorities that should be trusted by
this defender.

Parameters:

* `type` (`enum(Any | X509 | SSH)`): Type of certificate to get.

===== `GET /namespaces/:id/trustedcas`

Returns the list of trusted CAs for this namespace.

Parameters:

* `type` (`enum(Any | X509 | SSH | JWT)`): Type of certificate to get.

==== Attributes

===== `certificate` [`autogenerated`,`read_only`]

Type: `string`

The private certificate of the corresponding type associated with this
namespace.

===== `controller` [`autogenerated`,`read_only`]

Type: `string`

The controller that this certificate or CA was issued from.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

The namespace that this certificate or CA was defined at.

===== `namespaceID` [`autogenerated`,`read_only`]

Type: `string`

The ID of namespace that this certificate or CA was defined at.

===== `serialnumber` [`autogenerated`,`read_only`]

Type: `string`

SerialNumber is the serial number of the certificate.

===== `type` [`autogenerated`,`read_only`]

Type: `enum(X509 | SSH | JWT)`

Type of the certificate.

=== TrustedNamespace

This object allows you to declare trust between namespaces that are
cryptographically isolated. The namespaces can be local or served by
different Segment Console controllers.

==== Example

[source,json]
----
{
  "certificateAuthority": "-----BEGIN CERTIFICATE-----
MIIBbjCCARSgAwIBAgIRANRbvVzTzBZOvMCb8BiKCLowCgYIKoZIzj0EAwIwJjEN
MAsGA1UEChMEQWNtZTEVMBMGA1UEAxMMQWNtZSBSb290IENBMB4XDTE4MDExNTE4
NDgwN1oXDTI3MTEyNDE4NDgwN1owJjENMAsGA1UEChMEQWNtZTEVMBMGA1UEAxMM
QWNtZSBSb290IENBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEJ/80HR51+vau
7XH7zS7b8ABA0e/TdBOg1NznbnXdXil1tDvWloWuH5+/bbaiEg54wksJHFXaukw8
jhTLU7zT56MjMCEwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wCgYI
KoZIzj0EAwIDSAAwRQIhALwAZh2KLFFC1qfb5CqFHExlXS0PUltax9PvQCN9P0vl
AiBl7/st9u/JpERjJgirxJxOgKNlV6pq9ti75EfQtZZcQA==
-----END CERTIFICATE-----",
  "name": "the name",
  "protected": false
}
----

==== Relations

===== `GET /trustednamespaces`

Retrieves the list of trusted namespaces.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /trustednamespaces`

Creates a new trusted namespace.

===== `DELETE /trustednamespaces/:id`

Delete the trusted namespace with the given ID.

===== `GET /trustednamespaces/:id`

Retrieve the trusted namespace with the given ID.

===== `PUT /trustednamespaces/:id`

Update the trusted namespace with the given ID.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `certificateAuthority`

Type: `string`

Contains the PEM block of the certificate authority trusted namespace.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `propagate` [`autogenerated`,`read_only`]

Type: `boolean`

Propagates the object to all of its children.

Default value:

[source,json]
----
true
----

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `remoteController` [`autogenerated`,`read_only`]

Type: `string`

The controller declared in the certificate authority.

===== `remoteNamespace` [`autogenerated`,`read_only`]

Type: `string`

The namespace declared in the certificate authority.

===== `serialNumber` [`autogenerated`,`read_only`]

Type: `string`

The serial number of the CA.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.
