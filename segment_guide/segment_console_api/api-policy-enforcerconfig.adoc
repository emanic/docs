== policy/enforcerconfig

=== EnforcerProfile

Allows you to create reusable configuration profiles for your enforcers.
Enforcer profiles contain various startup information that can (for
some) be updated live. Enforcer profiles are assigned to enforcers using
an enforcer profile mapping.

==== Example

[source,json]
----
{
  "kubernetesMetadataExtractor": "PodAtomic",
  "kubernetesSupportEnabled": false,
  "metadataExtractor": "Docker",
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /enforcerprofiles`

Retrieves the list of enforcer profiles.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /enforcerprofiles`

Creates a new enforcer profile.

===== `DELETE /enforcerprofiles/:id`

Deletes the enforcer profile with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /enforcerprofiles/:id`

Retrieves the enforcer profile with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /enforcerprofiles/:id`

Updates the enforcer profile with the given ID.

===== `GET /enforcerprofilemappingpolicies/:id/enforcerprofiles`

Returns the list of enforcer profiles that an enforcer profile mapping
matches.

===== `GET /enforcers/:id/enforcerprofiles`

Returns the enforcer profile that must be used by an enforcer.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `excludedInterfaces` `[]string`

Ignore traffic with a source or destination matching the specified
interfaces.

===== `excludedNetworks` `[]string`

Ignore any networks specified here and do not even report any flows.
This can be useful for excluding localhost loopback traffic, ignoring
traffic to the Kubernetes API, and using Aporeto for SSH only.

===== `ignoreExpression` `[][]string`

A tag expression that identifies processing units to ignore. This can be
useful to exclude `kube-system` pods, AWS EC2 agent pods, and
third-party agents.

===== `kubernetesMetadataExtractor` `enum(KubeSquall | PodAtomic | PodContainers)`

_This attribute is deprecated_.

This field is kept for backward compatibility for enforcers <= 3.5.

Default value:

[source,json]
----
"PodAtomic"
----

===== `kubernetesSupportEnabled` `boolean`

_This attribute is deprecated_.

This field is kept for backward compatibility for enforcers <= 3.5.

===== `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `metadataExtractor` `enum(Docker | ECS | Kubernetes)`

_This attribute is deprecated_.

This field is kept for backward compatibility for enforcers <= 3.5.

Default value:

[source,json]
----
"Docker"
----

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `propagate` `boolean`

Propagates the policy to all of its children.

===== `protected` `boolean`

Defines if the object is protected.

===== `targetNetworks` `[]string`

If empty, the enforcer auto-discovers the TCP networks. Auto-discovery
works best in Kubernetes and OpenShift deployments. You may need to
manually specify the TCP networks if middle boxes exist that do not
comply with https://tools.ietf.org/html/rfc7413[TCP Fast Open RFC 7413].

===== `targetUDPNetworks` `[]string`

If empty, Aporeto enforces all UDP networks. This works best when all
UDP networks have enforcers. If some UDP networks do not have enforcers,
you may need to manually specify the UDP networks that should be
enforced.

===== `trustedCAs` `[]string`

List of trusted certificate authorities. If empty, the main chain of
trust will be used.

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

=== EnforcerProfileMappingPolicy

Allows you to map an enforcer profile to one or more enforcers. The
mapping can also be propagated down to the child namespace.

==== Example

[source,json]
----
{
  "disabled": false,
  "fallback": false,
  "name": "the name",
  "object": [
    [
      "a=a",
      "b=b"
    ],
    [
      "c=c"
    ]
  ],
  "propagate": false,
  "protected": false,
  "subject": [
    [
      "a=a",
      "b=b"
    ],
    [
      "c=c"
    ]
  ]
}
----

==== Relations

===== `GET /enforcerprofilemappingpolicies`

Retrieves the list of enforcer profile mappings.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /enforcerprofilemappingpolicies`

Creates a new enforcer profile mappings.

===== `DELETE /enforcerprofilemappingpolicies/:id`

Deletes the mapping with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /enforcerprofilemappingpolicies/:id`

Retrieves the mapping with the given ID.

===== `PUT /enforcerprofilemappingpolicies/:id`

Updates the mapping with the given ID.

===== `GET /enforcerprofilemappingpolicies/:id/enforcerprofiles`

Returns the list of enforcer profiles that an enforcer profile mapping
matches.

===== `GET /enforcerprofilemappingpolicies/:id/enforcers`

Returns the list of enforcers affected by an enforcer profile mapping.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `disabled` `boolean`

Defines if the property is disabled.

===== `fallback` `boolean`

Indicates that this is fallback policy. It will only be applied if no
other policies have been resolved. If the policy is also propagated it
will become a fallback for children namespaces.

===== `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `object` `[][]string`

The tag or tag expression that identifies the enforcer profile to be
mapped.

===== `propagate` `boolean`

Propagates the policy to all of its children.

===== `protected` `boolean`

Defines if the object is protected.

===== `subject` `[][]string`

The tag or tag expression that identifies the enforcers that should
implement the mapped profile.

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

=== TrustedCA

Represents a trusted certificate authority (CA).

==== Relations

===== `GET /trustedcas`

Retrieves the trusted CAs of a namespace.

Parameters:

* `type` (`enum(Any | X509 | SSH | JWT)`): The type of certificates that
it should return.

===== `GET /enforcers/:id/trustedcas`

Returns the list of certificate authorities that should be trusted by
this enforcer.

Parameters:

* `type` (`enum(Any | X509 | SSH)`): Type of certificate to get.

===== `GET /namespaces/:id/trustedcas`

Returns the list of trusted CAs for this namespace.

Parameters:

* `type` (`enum(Any | X509 | SSH | JWT)`): Type of certificate to get.

==== Attributes

===== `certificate` `string` [`autogenerated`,`read_only`]

The private certificate of the corresponding type associated with this
namespace.

===== `controller` `string` [`autogenerated`,`read_only`]

The controller that this certificate or CA was issued from.

===== `namespace` `string` [`autogenerated`,`read_only`]

The namespace that this certificate or CA was defined at.

===== `namespaceID` `string` [`autogenerated`,`read_only`]

The ID of namespace that this certificate or CA was defined at.

===== `serialnumber` `string` [`autogenerated`,`read_only`]

SerialNumber is the serial number of the certificate.

===== `type` `enum(X509 | SSH | JWT)` [`autogenerated`,`read_only`]

Type of the certificate.

=== TrustedNamespace

This objects allows to declare trust between namespaces that
cryptographically isolated. The namespaces can be local or served by
different Aporeto controller.

==== Example

[source,json]
----
{
  "certificateAuthority": "-----BEGIN CERTIFICATE-----
MIIBbjCCARSgAwIBAgIRANRbvVzTzBZOvMCb8BiKCLowCgYIKoZIzj0EAwIwJjEN
MAsGA1UEChMEQWNtZTEVMBMGA1UEAxMMQWNtZSBSb290IENBMB4XDTE4MDExNTE4
NDgwN1oXDTI3MTEyNDE4NDgwN1owJjENMAsGA1UEChMEQWNtZTEVMBMGA1UEAxMM
QWNtZSBSb290IENBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEJ/80HR51+vau
7XH7zS7b8ABA0e/TdBOg1NznbnXdXil1tDvWloWuH5+/bbaiEg54wksJHFXaukw8
jhTLU7zT56MjMCEwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wCgYI
KoZIzj0EAwIDSAAwRQIhALwAZh2KLFFC1qfb5CqFHExlXS0PUltax9PvQCN9P0vl
AiBl7/st9u/JpERjJgirxJxOgKNlV6pq9ti75EfQtZZcQA==
-----END CERTIFICATE-----",
  "name": "the name",
  "protected": false
}
----

==== Relations

===== `GET /trustednamespaces`

Retrieves the list of trusted namespaces.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /trustednamespaces`

Creates a new trusted namespace.

===== `DELETE /trustednamespaces/:id`

Delete the trusted namespace with the given ID.

===== `GET /trustednamespaces/:id`

Retrieve the trusted namespace with the given ID.

===== `PUT /trustednamespaces/:id`

Update the trusted namespace with the given ID.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `certificateAuthority` `string`

Contains the PEM block of the certificate authority trusted namespace.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `propagate` `boolean` [`autogenerated`,`read_only`]

Propagates the object to all of its children.

Default value:

[source,json]
----
true
----

===== `protected` `boolean`

Defines if the object is protected.

===== `remoteController` `string` [`autogenerated`,`read_only`]

The controller declared in the certificate authority.

===== `remoteNamespace` `string` [`autogenerated`,`read_only`]

The namespace declared in the certificate authority.

===== `serialNumber` `string` [`autogenerated`,`read_only`]

The serial number of the CA.

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.
