== integration/automation

=== Automation

Allows you to define some code and specify the conditions under which it
should be executed.

==== Example

[source,json]
----
{
  "condition": "function when(m, params) { return { continue: true }}",
  "disabled": false,
  "immediateExecution": false,
  "name": "the name",
  "protected": false,
  "tokenRenew": false,
  "trigger": "Time"
}
----

==== Relations

===== `GET /automations`

Retrieves the list of automations.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `POST /automations`

Creates a new Automation.

===== `DELETE /automations/:id`

Deletes the automation with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /automations/:id`

Retrieves the automation with the given ID.

===== `PUT /automations/:id`

Updates the automation with the given ID.

===== `GET /automations/:id/triggers`

Allows a system to trigger the automation if its `trigger` property is
set to `RemoteCall`.

===== `POST /automations/:id/triggers`

Allows a system to trigger the automation if its `trigger` property is
set to `RemoteCall`.

==== Attributes

===== `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

===== `actions` `[]string`

Contains the code that will be executed if the condition is met.

===== `annotations` `map[string][]string`

Stores additional information about an entity.

===== `associatedTags` `[]string`

List of tags attached to an entity.

===== `condition` `string`

Condition contains the code that will be executed to decide if any
action(s) should be executed. Providing a condition for an automation
with a ``Webhook'' trigger type will have no impact as the condition
will not be evaluated. If no condition is defined, then the automation
action(s) will be executed; this behaves akin to a condition that always
succeeds.

===== `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `disabled` `boolean`

Defines if the property is disabled.

===== `entitlements` `_automation_entitlements`

Declares which operations are allowed on which identities.

===== `errors` `[]string` [`autogenerated`,`read_only`]

Contains the error of the last run.

===== `events` `_automation_events`

Contains the identity and operation an event must have to trigger the
automation.

===== `immediateExecution` `boolean`

If set and the trigger is of type Time, the automation will be run at
create or update before being scheduled.

===== `lastExecTime` `time` [`autogenerated`,`read_only`]

The last successful execution tine.

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

===== `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

===== `parameters` `map[string]interface{}`

Contains the computed parameters.

===== `protected` `boolean`

Defines if the object is protected.

===== `schedule` `string`

Specifies when to run the automation. Must be in valid CRON format. This
only applies if the trigger is set to `Time`.

===== `signature` `string`

Signature to validate the authenticity of the object.

===== `stdout` `string` [`autogenerated`,`read_only`]

Contains the standard output of the last run.

===== `token` `string` [`autogenerated`]

Holds the unique access token used as a password to trigger the
authentication. It will be visible only after creation.

===== `tokenRenew` `boolean`

If set to `true` a new token will be issued and the previous one
invalidated.

===== `trigger` `enum(Event | RemoteCall | Webhook | Time)`

Controls when the automation should be triggered.

Default value:

[source,json]
----
"Time"
----

===== `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

=== AutomationTemplate

Templates that can be used in automations.

==== Example

[source,json]
----
{
  "kind": "Condition",
  "name": "the name"
}
----

==== Relations

===== `GET /automationtemplates`

Retrieves the list of automation templates.

===== `GET /automationtemplates/:id`

Retrieves the template with the given ID.

==== Attributes

===== `description` `string` [`max_length=1024`]

Description of the object.

===== `entitlements` `_automation_entitlements`

Contains the entitlements needed for executing the function.

===== `function` `string`

Function contains the code.

===== `key` `string`

Contains the unique identifier key for the template.

===== `kind` `enum(Action | Condition)`

Represents the kind of template.

Default value:

[source,json]
----
"Condition"
----

===== `name` `string` [`required`,`max_length=256`]

Name of the entity.

===== `parameters` `map[string]interface{}`

Contains the computed parameters.

===== `steps` link:#uistep[`[]uistep`]

Contains all the steps with parameters.

=== Trigger

Can be used to remotely trigger an automation.

==== Relations

===== `GET /automations/:id/triggers`

Allows a system to trigger the automation if its `trigger` property is
set to `RemoteCall`.

===== `POST /automations/:id/triggers`

Allows a system to trigger the automation if its `trigger` property is
set to `RemoteCall`.
