== policy/audit

=== AuditProfile

A set of audit rules that determine the types of events that must be
captured in the kernel.

==== Example

[source,json]
----
{
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /auditprofiles`

Retrieves the list of audit profiles.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /auditprofiles`

Creates a new audit profile.

===== `DELETE /auditprofiles/:id`

Deletes the profile with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /auditprofiles/:id`

Retrieves the object with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /auditprofiles/:id`

Updates the profile with the given ID.

===== `GET /auditprofilemappingpolicies/:id/auditprofiles`

Returns the list of audit profiles that are referred to by this mapping.

===== `GET /enforcers/:id/auditprofiles`

Returns a list of the audit profiles that must be applied to this
defender.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `metadata` [`creation_only`]

Type: `[]string`

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `rules`

Type: `_audit_profile_rule_list`

List of audit rules associated with this profile.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== AuditProfileMappingPolicy

Use an audit profile mapping to define the set of defenders that must
implement a specific audit profile.

==== Example

[source,json]
----
{
  "disabled": false,
  "fallback": false,
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /auditprofilemappingpolicies`

Retrieves the list of audit profile mapping policies.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /auditprofilemappingpolicies`

Creates a new audit profile mapping policy.

===== `DELETE /auditprofilemappingpolicies/:id`

Deletes the mapping with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /auditprofilemappingpolicies/:id`

Retrieves the mapping with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /auditprofilemappingpolicies/:id`

Updates the mapping with the given ID.

===== `GET /auditprofilemappingpolicies/:id/auditprofiles`

Returns the list of audit profiles that are referred to by this mapping.

===== `GET /auditprofilemappingpolicies/:id/enforcers`

Returns the list of defenders that are affected by this mapping.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `activeDuration` [`format=^[0-9]+[smh]$`]

Type: `string`

Defines for how long the policy will be active according to the
`activeSchedule`.

===== `activeSchedule`

Type: `string`

Defines when the policy should be active using the cron notation. The
policy will be active for the given `activeDuration`.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `disabled`

Type: `boolean`

Defines if the property is disabled.

===== `fallback`

Type: `boolean`

Indicates that this is fallback policy. It will only be applied if no
other policies have been resolved. If the policy is also propagated it
will become a fallback for children namespaces.

===== `metadata` [`creation_only`]

Type: `[]string`

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `object`

Type: `[][]string`

The tag or tag expression that identifies the audit profile to be
mapped.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `subject`

Type: `[][]string`

The tag or tag expression that identifies the defender(s) to implement
the audit profile.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== AuditReport

Post a new audit report.

==== Example

[source,json]
----
{
  "AUID": "xxx-xxx",
  "CWD": "/etc",
  "EXE": "/bin/ls",
  "a0": "xxx-xxx",
  "a1": "xxx-xxx",
  "a2": "xxx-xxx",
  "a3": "xxx-xxx",
  "arch": "x86_64",
  "auditProfileID": "xxx-xxx-xxx-xxx",
  "auditProfileNamespace": "/my/ns",
  "command": "ls",
  "enforcerID": "xxx-xxx-xxx-xxx",
  "enforcerNamespace": "/my/ns",
  "processingUnitID": "xxx-xxx-xxx-xxx",
  "processingUnitNamespace": "/my/ns",
  "recordType": "Syscall",
  "success": false,
  "syscall": "execve",
  "timestamp": "2018-06-14T23:10:46.420397985Z"
}
----

==== Relations

===== `POST /auditreports`

Create a audit statistics report.

==== Attributes

===== `AUID`

Type: `string`

The login ID of the user who started the audited process.

===== `CWD`

Type: `string`

Command working directory.

===== `EGID`

Type: `integer`

Effective group ID of the user who started the audited process.

===== `EUID`

Type: `integer`

Effective user ID of the user who started the audited process.

===== `EXE`

Type: `string`

Path to the executable.

===== `FSGID`

Type: `integer`

File system group ID of the user who started the audited process.

===== `FSUID`

Type: `integer`

File system user ID of the user who started the audited process.

===== `FilePath`

Type: `string`

Full path of the file that was passed to the system call.

===== `GID`

Type: `integer`

Group ID of the user who started the analyzed process.

===== `PER`

Type: `integer`

File or directory permissions.

===== `PID`

Type: `integer`

Process ID of the executable.

===== `PPID`

Type: `integer`

Process ID of the parent executable.

===== `SGID`

Type: `integer`

Set group ID of the user who started the audited process.

===== `SUID`

Type: `integer`

Set user ID of the user who started the audited process.

===== `UID`

Type: `integer`

User ID.

===== `a0`

Type: `string`

First argument of the executed system call.

===== `a1`

Type: `string`

Second argument of the executed system call.

===== `a2`

Type: `string`

Third argument of the executed system call.

===== `a3`

Type: `string`

Fourth argument of the executed system call.

===== `arch`

Type: `string`

Architecture of the system of the monitored process.

===== `arguments`

Type: `[]string`

Arguments passed to the command.

===== `auditProfileID` [`required`]

Type: `string`

ID of the audit profile that triggered the report.

===== `auditProfileNamespace` [`required`]

Type: `string`

Namespace of the audit profile that triggered the report.

===== `command`

Type: `string`

Command issued.

===== `enforcerID` [`required`]

Type: `string`

ID of the defender reporting.

===== `enforcerNamespace` [`required`]

Type: `string`

Namespace of the defender reporting.

===== `exit`

Type: `integer`

Exit code of the executed system call.

===== `processingUnitID` [`required`]

Type: `string`

ID of the processing unit originating the report.

===== `processingUnitNamespace` [`required`]

Type: `string`

Namespace of the processing unit originating the report.

===== `recordType` [`required`]

Type: `string`

Type of audit record.

===== `sequence`

Type: `integer`

Needs documentation.

===== `success`

Type: `boolean`

Tells if the operation has been a success or a failure.

===== `syscall`

Type: `string`

System call executed.

===== `timestamp` [`required`]

Type: `time`

Date of the report.
