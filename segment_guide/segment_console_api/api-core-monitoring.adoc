== core/monitoring

=== Activity

Contains logs of all the activity that happened in a namespace. All
successful or failed actions will be available, errors, as well as the
claims of the user who triggered the actions. This log is capped and
only keeps the last 50,000 entries by default.

==== Relations

===== `GET /activities`

Retrieves the list of activity logs.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /activities/:id`

Retrieves the object with the given ID.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `claims` [`autogenerated`,`read_only`]

Type: `object`

Claims of the user who performed the operation.

===== `data` [`autogenerated`,`read_only`]

_This attribute is deprecated_.

Type: `object`

This is deprecated in favor of `diff`.

===== `date` [`autogenerated`,`read_only`]

Type: `time`

Time-date stamp of the notification.

===== `diff` [`autogenerated`,`read_only`]

Type: `string`

Contains the diff of the change.

===== `error` [`autogenerated`,`read_only`]

Type: `object`

Contains the error.

===== `message`

Type: `string`

Message of the notification.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `operation` [`autogenerated`,`read_only`]

Type: `string`

Describes what kind of operation the notification represents.

===== `originalData` [`autogenerated`,`read_only`]

_This attribute is deprecated_.

Type: `object`

This is deprecated in favor of `diff`.

===== `source` [`autogenerated`,`read_only`]

Type: `string`

Contains meta information about the source.

===== `targetIdentity` [`autogenerated`,`read_only`]

Type: `string`

The identity of the related object.

=== Alarm

Represents an event requiring attention.

==== Example

[source,json]
----
{
  "content": "This is an alarm",
  "emails": [
    "amir@aporeto.com",
    "john@aporeto.com"
  ],
  "kind": "aporeto.alarm.kind",
  "name": "the name",
  "protected": false,
  "status": "Open"
}
----

==== Relations

===== `GET /alarms`

Retrieves all the alarms.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `POST /alarms`

Creates a new alarm.

===== `DELETE /alarms/:id`

Deletes the object with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /alarms/:id`

Retrieves the object with the given ID.

===== `PUT /alarms/:id`

Updates the object with the given ID.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `content` [`required`,`creation_only`]

Type: `string`

Content of the alarm.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `data`

Type: `[]map[string]string`

Data represent user data related to the alarms.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `emails`

Type: `[]string`

A list of recipients that should be emailed when this alarm is created.

===== `kind` [`required`,`creation_only`]

Type: `string`

Identifies the kind of alarm. If two alarms are created with the same
identifier, then only the occurrence will be incremented.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `occurrences` [`autogenerated`,`creation_only`]

Type: `[]time.Time`

Number of times this alarm has been seen.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `status`

Type: `enum(Acknowledged | Open | Resolved)`

Status of the alarm.

Default value:

[source,json]
----
"Open"
----

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== EventLog

Allows you to report various events on any object.

==== Example

[source,json]
----
{
  "category": "enforcerd:policy",
  "content": "Unable to activate docker container xyz because abc.",
  "level": "Info",
  "targetID": "xxx-xxx-xxx-xxx",
  "targetIdentity": "processingunit",
  "title": "Error while activating processing unit."
}
----

==== Relations

===== `POST /eventlogs`

Creates a new event log for a particular entity.

==== Attributes

===== `category` [`required`,`creation_only`]

Type: `string`

Category of the event log.

===== `content` [`required`,`creation_only`]

Type: `string`

Content of the event log.

===== `date` [`autogenerated`,`creation_only`]

Type: `time`

Creation date of the event log.

===== `level` [`creation_only`]

Type: `enum(Debug | Info | Warning | Error | Critical)`

Sets the log level.

Default value:

[source,json]
----
"Info"
----

===== `namespace` [`autogenerated`,`read_only`,`creation_only`]

Type: `string`

Namespace tag attached to the event log.

===== `opaque` [`creation_only`]

Type: `string`

Opaque data that can be attached to the event log, for further machine
processing.

===== `targetID` [`required`,`creation_only`]

Type: `string`

ID of the object this event log is attached to. The object must be in
the same namespace than the event log.

===== `targetIdentity` [`required`,`creation_only`]

Type: `string`

Identity of the object this event log is attached to.

===== `title` [`required`,`creation_only`]

Type: `string`

Title of the event log.

=== HealthCheck

This API allows to retrieve a generic health state of the platform. A
return code different from 200 OK means the platform is not operational.
The health check contains the list of observed sub system.

==== Relations

===== `GET /healthchecks`

Retrieve the health of the platform.

Parameters:

* `quiet` (`boolean`): If set to true, the health check endpoint will
not return data but will return 200 OK if everything is fine or 218 if
the controller is not operational. This is useful when you want to use
the health check endpoint as a load balancer health check.

==== Attributes

===== `alerts` [`autogenerated`,`read_only`]

Type: `[]string`

A human readable alert list describing the current state of the sub
system if available.

===== `name` [`autogenerated`,`read_only`]

Type: `string`

The name of the observed sub system if applicable.

===== `responseTime` [`autogenerated`,`read_only`]

Type: `string`

The response time of the observed sub system if applicable.

===== `status` [`autogenerated`,`read_only`]

Type: `enum(Degraded | Offline | Operational)`

The current health of the observed sub system.

===== `type` [`autogenerated`,`read_only`]

Type:
`enum(Cache | Database | General | MessagingSystem | Service | TSDB)`

The type of the observed sub system.

=== Message

Allows you to post public messages that will be visible through all
children namespaces.

==== Example

[source,json]
----
{
  "level": "Info",
  "name": "the name",
  "propagate": false,
  "protected": false
}
----

==== Relations

===== `GET /messages`

Retrieves the list of messages.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /messages`

Creates a new message.

===== `DELETE /messages/:id`

Deletes the message with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /messages/:id`

Retrieves the message with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /messages/:id`

Updates the message with the given ID.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `expirationTime`

Type: `time`

The time after which the message will be deleted.

===== `level`

Type: `enum(Danger | Info | Warning)`

Importance of the message.

Default value:

[source,json]
----
"Info"
----

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

===== `validity` [`format=^[0-9]+[smh]$`]

Type: `string`

Sets when the message will be automatically deleted using
https://golang.org/pkg/time/#example_Duration[Golang duration syntax].
