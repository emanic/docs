## policy/audit

### AuditProfile

A set of audit rules that determine the types of events that must be captured in
the kernel.

#### Example

```json
{
  "name": "the name",
  "propagate": false,
  "protected": false
}
```

#### Relations

##### `GET /auditprofiles`

Retrieves the list of audit profiles.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.
- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `POST /auditprofiles`

Creates a new audit profile.

##### `DELETE /auditprofiles/:id`

Deletes the profile with the given ID.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.

##### `GET /auditprofiles/:id`

Retrieves the object with the given ID.

Parameters:

- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `PUT /auditprofiles/:id`

Updates the profile with the given ID.

##### `GET /auditprofilemappingpolicies/:id/auditprofiles`

Returns the list of audit profiles that are referred to by this mapping.

##### `GET /enforcers/:id/auditprofiles`

Returns a list of the audit profiles that must be applied to this enforcer.

#### Attributes

##### `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

##### `annotations` `map[string][]string`

Stores additional information about an entity.

##### `associatedTags` `[]string`

List of tags attached to an entity.

##### `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

##### `description` `string` [`max_length=1024`]

Description of the object.

##### `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start
with the '@' prefix, and should only be used by external systems.

##### `name` `string` [`required`,`max_length=256`]

Name of the entity.

##### `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

##### `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

##### `propagate` `boolean`

Propagates the policy to all of its children.

##### `protected` `boolean`

Defines if the object is protected.

##### `rules` `_audit_profile_rule_list`

List of audit rules associated with this profile.

##### `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

### AuditProfileMappingPolicy

Use an audit profile mapping to define the set of enforcers that must
implement a specific audit profile.

#### Example

```json
{
  "disabled": false,
  "fallback": false,
  "name": "the name",
  "propagate": false,
  "protected": false
}
```

#### Relations

##### `GET /auditprofilemappingpolicies`

Retrieves the list of audit profile mapping policies.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.
- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `POST /auditprofilemappingpolicies`

Creates a new audit profile mapping policy.

##### `DELETE /auditprofilemappingpolicies/:id`

Deletes the mapping with the given ID.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.

##### `GET /auditprofilemappingpolicies/:id`

Retrieves the mapping with the given ID.

Parameters:

- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `PUT /auditprofilemappingpolicies/:id`

Updates the mapping with the given ID.

##### `GET /auditprofilemappingpolicies/:id/auditprofiles`

Returns the list of audit profiles that are referred to by this mapping.

##### `GET /auditprofilemappingpolicies/:id/enforcers`

Returns the list of enforcers that are affected by this mapping.

#### Attributes

##### `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

##### `activeDuration` `string` [`format=^[0-9]+[smh]$`]

Defines for how long the policy will be active according to the
`activeSchedule`.

##### `activeSchedule` `string`

Defines when the policy should be active using the cron notation.
The policy will be active for the given `activeDuration`.

##### `annotations` `map[string][]string`

Stores additional information about an entity.

##### `associatedTags` `[]string`

List of tags attached to an entity.

##### `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

##### `description` `string` [`max_length=1024`]

Description of the object.

##### `disabled` `boolean`

Defines if the property is disabled.

##### `fallback` `boolean`

Indicates that this is fallback policy. It will only be
applied if no other policies have been resolved. If the policy is also
propagated it will become a fallback for children namespaces.

##### `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start
with the '@' prefix, and should only be used by external systems.

##### `name` `string` [`required`,`max_length=256`]

Name of the entity.

##### `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

##### `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

##### `object` `[][]string`

The tag or tag expression that identifies the audit profile to be mapped.

##### `propagate` `boolean`

Propagates the policy to all of its children.

##### `protected` `boolean`

Defines if the object is protected.

##### `subject` `[][]string`

The tag or tag expression that identifies the enforcer(s) to implement the audit profile.

##### `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

### AuditReport

Post a new audit report.

#### Example

```json
{
  "AUID": "xxx-xxx",
  "CWD": "/etc",
  "EXE": "/bin/ls",
  "a0": "xxx-xxx",
  "a1": "xxx-xxx",
  "a2": "xxx-xxx",
  "a3": "xxx-xxx",
  "arch": "x86_64",
  "auditProfileID": "xxx-xxx-xxx-xxx",
  "auditProfileNamespace": "/my/ns",
  "command": "ls",
  "enforcerID": "xxx-xxx-xxx-xxx",
  "enforcerNamespace": "/my/ns",
  "processingUnitID": "xxx-xxx-xxx-xxx",
  "processingUnitNamespace": "/my/ns",
  "recordType": "Syscall",
  "success": false,
  "syscall": "execve",
  "timestamp": "2018-06-14T23:10:46.420397985Z"
}
```

#### Relations

##### `POST /auditreports`

Create a audit statistics report.

#### Attributes

##### `AUID` `string`

The login ID of the user who started the audited process.

##### `CWD` `string`

Command working directory.

##### `EGID` `integer`

Effective group ID of the user who started the audited process.

##### `EUID` `integer`

Effective user ID of the user who started the audited process.

##### `EXE` `string`

Path to the executable.

##### `FSGID` `integer`

File system group ID of the user who started the audited process.

##### `FSUID` `integer`

File system user ID of the user who started the audited process.

##### `FilePath` `string`

Full path of the file that was passed to the system call.

##### `GID` `integer`

Group ID of the user who started the analyzed process.

##### `PER` `integer`

File or directory permissions.

##### `PID` `integer`

Process ID of the executable.

##### `PPID` `integer`

Process ID of the parent executable.

##### `SGID` `integer`

Set group ID of the user who started the audited process.

##### `SUID` `integer`

Set user ID of the user who started the audited process.

##### `UID` `integer`

User ID.

##### `a0` `string`

First argument of the executed system call.

##### `a1` `string`

Second argument of the executed system call.

##### `a2` `string`

Third argument of the executed system call.

##### `a3` `string`

Fourth argument of the executed system call.

##### `arch` `string`

Architecture of the system of the monitored process.

##### `arguments` `[]string`

Arguments passed to the command.

##### `auditProfileID` `string` [`required`]

ID of the audit profile that triggered the report.

##### `auditProfileNamespace` `string` [`required`]

Namespace of the audit profile that triggered the report.

##### `command` `string`

Command issued.

##### `enforcerID` `string` [`required`]

ID of the enforcer reporting.

##### `enforcerNamespace` `string` [`required`]

Namespace of the enforcer reporting.

##### `exit` `integer`

Exit code of the executed system call.

##### `processingUnitID` `string` [`required`]

ID of the processing unit originating the report.

##### `processingUnitNamespace` `string` [`required`]

Namespace of the processing unit originating the report.

##### `recordType` `string` [`required`]

Type of audit record.

##### `sequence` `integer`

Needs documentation.

##### `success` `boolean`

Tells if the operation has been a success or a failure.

##### `syscall` `string`

System call executed.

##### `timestamp` `time` [`required`]

Date of the report.

