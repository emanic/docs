## core/processingunit

### DataPathCertificate

Used by enforcer instances to retrieve various certificates used
for the datapath.

#### Example

```json
{
  "CSR": "-----BEGIN CERTIFICATE REQUEST-----
MIICvDCCAaQCAQAwdzELMAkGA1UEBhMCVVMxDTALBgNVBAgMBFV0YWgxDzANBgNV
BAcMBkxpbmRvbjEWMBQGA1UECgwNRGlnaUNlcnQgSW5jLjERMA8GA1UECwwIRGln
aUNlcnQxHTAbBgNVBAMMFGV4YW1wbGUuZGlnaWNlcnQuY29tMIIBIjANBgkqhkiG
9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8+To7d+2kPWeBv/orU3LVbJwDrSQbeKamCmo
wp5bqDxIwV20zqRb7APUOKYoVEFFOEQs6T6gImnIolhbiH6m4zgZ/CPvWBOkZc+c
1Po2EmvBz+AD5sBdT5kzGQA6NbWyZGldxRthNLOs1efOhdnWFuhI162qmcflgpiI
WDuwq4C9f+YkeJhNn9dF5+owm8cOQmDrV8NNdiTqin8q3qYAHHJRW28glJUCZkTZ
wIaSR6crBQ8TbYNE0dc+Caa3DOIkz1EOsHWzTx+n0zKfqcbgXi4DJx+C1bjptYPR
BPZL8DAeWuA8ebudVT44yEp82G96/Ggcf7F33xMxe0yc+Xa6owIDAQABoAAwDQYJ
KoZIhvcNAQEFBQADggEBAB0kcrFccSmFDmxox0Ne01UIqSsDqHgL+XmHTXJwre6D
hJSZwbvEtOK0G3+dr4Fs11WuUNt5qcLsx5a8uk4G6AKHMzuhLsJ7XZjgmQXGECpY
Q4mC3yT3ZoCGpIXbw+iP3lmEEXgaQL0Tx5LFl/okKbKYwIqNiyKWOMj7ZR/wxWg/
ZDGRs55xuoeLDJ/ZRFf9bI+IaCUd1YrfYcHIl3G87Av+r49YVwqRDT0VDV7uLgqn
29XI1PpVUNCPQGn9p/eX6Qo7vpDaPybRtA2R7XLKjQaF9oXWeCUqy1hvJac9QFO2
97Ob1alpHPoZ7mWiEuJwjBPii6a9M9G30nUo39lBi1w=
-----END CERTIFICATE REQUEST-----",
  "objectID": "5c83035648675400019ab901",
  "sessionID": "5c83035648675400019ab901",
  "type": "Service"
}
```

#### Relations

##### `POST /datapathcertificates`

Creates a new certificate for datapath.

#### Attributes

##### `CSR` `string` [`required`]

Contains the certificate signing request (CSR) the enforcer wants control plane
to sign.
Depending on the certificate there will be various requirements for the CSR to
be accepted.

##### `certificate` `string` [`autogenerated`,`read_only`]

The certificate.

##### `objectID` `string` [`required`]

ID of the object you want to issue a certificate for.

##### `sessionID` `string`

Provides the session ID of the enforcer when retrieving a datapath certificate.

##### `signer` `string` [`autogenerated`,`read_only`]

Contains the CA that signed the delivered certificate.

##### `token` `string` [`autogenerated`,`read_only`]

Contains a cryptographic token.

##### `type` `enum(Enforcer | Service | ServicePing)`

Type of certificate.

### Image

A container image can be affected by vulnerabilities.

#### Example

```json
{
  "hash": "sha256:4635a5562b040fd83ec821bb885405587a52cfef898ffb7402649005dfda75ff",
  "name": "the name",
  "propagate": false,
  "protected": false
}
```

#### Relations

##### `GET /images`

Retrieves the list of container images.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.
- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `POST /images`

Creates a new container image.

##### `GET /images/:id`

Retrieves a container image with a given ID.

##### `PUT /images/:id`

Updates the container image with the given ID.

#### Attributes

##### `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

##### `annotations` `map[string][]string`

Stores additional information about an entity.

##### `associatedTags` `[]string`

List of tags attached to an entity.

##### `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

##### `description` `string` [`max_length=1024`]

Description of the object.

##### `hash` `string`

Hash of the image.

##### `name` `string` [`required`,`max_length=256`]

Name of the entity.

##### `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

##### `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

##### `propagate` `boolean`

Propagates the policy to all of its children.

##### `protected` `boolean`

Defines if the object is protected.

##### `severity` `_vulnerability_level`

Overall severity of the container image.

##### `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

##### `vulnerabilities` `[]string`

List of vulnerabilities affecting this image.

### ImageVulnerability

Private API returning the tags related to eventual vulnerabilities for a one or
more given
images.

#### Relations

##### `GET /imagevulnerabilities`

Retrieves the list of vulnerabilities for a bunch of container images.

Parameters:

- `image` (`string`): Image to analyze.

Mandatory Parameters

`image`

##### `POST /imagevulnerabilities`

Creates a new vulnerability.

#### Attributes

##### `image` `string` [`autogenerated`,`read_only`]

Image name.

##### `severity` `_vulnerability_level` [`autogenerated`,`read_only`]

Overall severity of the vulnerabilities affecting the image.

##### `vulnerabilities` `[]string` [`autogenerated`,`read_only`]

List of vulnerabilities associated to the images.

### ProcessingUnit

A processing unit represents anything that can compute. It can be a Docker
container or a simple Unix process. Processing units are created, updated, and
deleted by
the system as they come and go. You can only modify their tags. Processing units
use network policies to define which other processing units or external
networks they can communicate with and file access policies to define what file
paths they can use.

#### Example

```json
{
  "collectInfo": false,
  "datapathType": "Aporeto",
  "enforcementStatus": "Inactive",
  "name": "the name",
  "operationalStatus": "Initialized",
  "protected": false,
  "type": "Docker"
}
```

#### Relations

##### `GET /processingunits`

Retrieves the list of processing units.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.
- `archived` (`boolean`): Also retrieve the objects that have been archived.

##### `POST /processingunits`

Creates a new processing unit.

##### `DELETE /processingunits/:id`

Deletes the processing unit with the given ID.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.

##### `GET /processingunits/:id`

Retrieves the processing unit with the given ID.

Parameters:

- `archived` (`boolean`): Also retrieve the objects that have been archived.

##### `PUT /processingunits/:id`

Updates the processing unit with the given ID.

##### `GET /fileaccesspolicies/:id/processingunits`

Returns the list of processing units that match the policy.

##### `GET /infrastructurepolicies/:id/processingunits`

Returns the list of processing units affected by an infrastructure policy.

Parameters:

- `mode` (`enum(subject | object)`): Matching mode.

##### `GET /networkaccesspolicies/:id/processingunits`

Returns the list of processing units affected by a network policy.

Parameters:

- `mode` (`enum(subject | object)`): Matching mode.

##### `GET /processingunitpolicies/:id/processingunits`

Returns the list of processing units referenced by the mapping.

##### `GET /servicedependencies/:id/processingunits`

Returns the list of processing units that depend on an service.

##### `GET /services/:id/processingunits`

Retrieves the processing units that implement this service.

##### `GET /vulnerabilities/:id/processingunits`

Retrieves the processing units affected by the vulnerability.

##### `POST /processingunits/:id/pingprobes`

Create a ping probe.

##### `GET /processingunits/:id/poke`

Sends a poke empty object. This will send a snapshot of the processing unit to
the time series database.

Parameters:

- `enforcementStatus` (`enum(Failed | Inactive | Active)`): If set, changes the enforcement status of the processing unit alongside with the poke.
- `forceFullPoke` (`boolean`): If set, it will trigger a full poke (slower).
- `notify` (`boolean`): Can be sent to trigger a `ProcessingUnitRefresh` event that will be handled by the enforcer. If this is set, all other additional parameters will be ignored.
- `status` (`enum(Initialized | Paused | Running | Stopped)`): If set, changes the status of the processing unit alongside with the poke.
- `ts` (`time`): time of report. If not set, local server time will be used.
- `zhash` (`integer`): Can be set to help backend target the correct shard where the processing unit is stored.

##### `POST /processingunits/:id/processingunitrefreshes`

Sends a Processing Unit Refresh command.

##### `GET /processingunits/:id/renderedpolicies`

Retrieves the policies for the processing unit.

Parameters:

- `csr` (`string`): CSR to sign.

##### `GET /processingunits/:id/services`

Retrieves the services used by a processing unit.

##### `GET /processingunits/:id/vulnerabilities`

Retrieves the vulnerabilities affecting the processing unit.

Parameters:

- `propagated` (`boolean`): Also retrieve the objects that propagate down.

#### Attributes

##### `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

##### `annotations` `map[string][]string`

Stores additional information about an entity.

##### `associatedTags` `[]string`

List of tags attached to an entity.

##### `collectInfo` `boolean`

A value of `true` indicates to the enforcer that it needs to collect information
for
this processing unit.

##### `collectedInfo` `map[string]string`

Represents the latest information collected by the enforcer for this processing
unit.

##### `controller` `string` [`autogenerated`,`read_only`]

The control plane identifier managing this object. This property is mostly
useful when federating multiple control planes.

##### `createTime` `time` [`autogenerated`,`read_only`]

Creation date of the object.

##### `datapathType` `enum(Aporeto | EnvoyAuthorizer)`

The datapath type that processing units are implementing:
- `Aporeto`: The enforcer is managing and handling the datapath.
- `EnvoyAuthorizer`: The enforcer is serving envoy compatible gRPC APIs
that for example can be used by an envoy proxy to use the Aporeto PKI
and implement Aporeto network access policies. NOTE: The enforcer is not
owning the datapath in this case. It is merely providing an authorizer API.

Default value:

```json
"Aporeto"
```

##### `description` `string` [`max_length=1024`]

Description of the object.

##### `enforcementStatus` `enum(Active | Failed | Inactive)`

Contains the state of the enforcer for the processing unit. `Inactive`
(default):
the enforcer is not enforcing any host service. `Active`: the enforcer is
enforcing
a host service. `Failed`.

Default value:

```json
"Inactive"
```

##### `enforcerID` `string`

The ID of the enforcer associated with the processing unit.

##### `enforcerNamespace` `string`

The namespace of the enforcer associated with the processing unit.

##### `image` `string`

_This attribute is deprecated_.

This field is deprecated and it is there for backward compatibility. Use
`images` instead.

##### `images` `[]string` [`creation_only`]

List of images or executable paths used by the processing unit.

##### `lastCollectionTime` `time`

The date and time when the information was collected.

##### `lastSyncTime` `time` [`autogenerated`]

The date and time of the last policy resolution.

##### `metadata` `[]string` [`creation_only`]

Contains tags that can only be set during creation, must all start
with the '@' prefix, and should only be used by external systems.

##### `name` `string` [`required`,`max_length=256`]

Name of the entity.

##### `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

##### `nativeContextID` `string`

The Docker UUID or service PID.

##### `networkServices` [`[]processingunitservice`](#processingunitservice)

The list of services that this processing unit has declared that it will be
listening to,
either in its activation command or by exposing the ports in a container
manifest.

##### `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

##### `operationalStatus` `enum(Initialized | Paused | Running | Stopped | Terminated)`

Operational status of the processing unit: `Initialized` (default), `Paused`,
`Running`,
`Stopped`, or `Terminated`.

Default value:

```json
"Initialized"
```

##### `protected` `boolean`

Defines if the object is protected.

##### `tracing` [`tracemode`](#tracemode)

Indicates if this processing unit must be placed in tracing mode.

##### `type` `enum(APIGateway | Docker | Host | HostService | LinuxService | RKT | User | SSHSession)` [`creation_only`]

Type of processing unit: `APIGateway`, `Docker`, `Host`, `HostService`,
`LinuxService`,
`RKT`, `User`, or `SSHSession`.

##### `updateTime` `time` [`autogenerated`,`read_only`]

Last update date of the object.

##### `vulnerabilityLevel` `string` [`autogenerated`,`read_only`]

List of vulnerabilities affecting this processing unit.

### Vulnerability

Represents a common vulnerability and exposure (CVE).

#### Example

```json
{
  "CVSS2Score": 3.2,
  "link": "https://cve.com/CVE-1234",
  "name": "the name",
  "propagate": false,
  "protected": false,
  "severity": 3
}
```

#### Relations

##### `GET /vulnerabilities`

Retrieves the list of vulnerabilities.

Parameters:

- `q` (`string`): Filtering query. Consequent `q` parameters will form an or.
- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `POST /vulnerabilities`

Creates a new vulnerability.

##### `GET /vulnerabilities/:id`

Retrieves the object with the given ID.

##### `GET /processingunits/:id/vulnerabilities`

Retrieves the vulnerabilities affecting the processing unit.

Parameters:

- `propagated` (`boolean`): Also retrieve the objects that propagate down.

##### `GET /vulnerabilities/:id/processingunits`

Retrieves the processing units affected by the vulnerability.

#### Attributes

##### `CVSS2Score` `float` [`creation_only`]

Common Vulnerability Scoring System (CVSS) version 2 score.

##### `ID` `string` [`identifier`,`autogenerated`,`read_only`]

Identifier of the object.

##### `annotations` `map[string][]string`

Stores additional information about an entity.

##### `associatedTags` `[]string`

List of tags attached to an entity.

##### `description` `string` [`max_length=1024`]

Description of the object.

##### `link` `string` [`autogenerated`,`required`,`creation_only`]

The URL that refers to the vulnerability.

##### `name` `string` [`required`,`max_length=256`]

Name of the entity.

##### `namespace` `string` [`autogenerated`,`read_only`]

Namespace tag attached to an entity.

##### `normalizedTags` `[]string` [`autogenerated`,`read_only`]

Contains the list of normalized tags of the entities.

##### `propagate` `boolean`

Propagates the policy to all of its children.

##### `protected` `boolean`

Defines if the object is protected.

##### `severity` `_vulnerability_level` [`required`,`creation_only`]

Refers to the security vulnerability level.

